{"ast":null,"code":"// ReminderPage.js\nimport\"./profil.css\";import React,{useState,useEffect}from\"react\";import axios from\"axios\";import{Link}from\"react-router-dom\";import UserProfileView from\"./seeProfil\";import Navbar from\"../navbar/navbar\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ReminderPage=()=>{const[hasAppointmentToday,setHasAppointmentToday]=useState(false);const[reminderMessage,setReminderMessage]=useState(\"\");useEffect(()=>{const fetchReminder=async()=>{try{const token=localStorage.getItem(\"token\");const usrId=localStorage.getItem(\"uid\");if(!token||!usrId){console.error(\"Token or user ID missing\");return;}const config={headers:{Authorization:`Bearer ${token}`}};const response=await axios.get(`https://avocat-backend.onrender.com/api/appointment/details/${usrId}`,config);const appointment=response.data;if(appointment&&appointment.time&&appointment.date){const today=new Date().toISOString().split(\"T\")[0];// yyyy-mm-dd\nconst appointmentDate=appointment.date.split(\"T\")[0];//Afficher les boutons confirmer et annuler que lorsque user a un RDV\nif(appointmentDate===today){var _appointment$appointm;const consultationRaw=((_appointment$appointm=appointment.appointmentDetails)===null||_appointment$appointm===void 0?void 0:_appointment$appointm.consultation)||\"\";const consultationType=consultationRaw.toLowerCase()===\"phone\"?\"téléphonique\":consultationRaw.toLowerCase()===\"online\"?\"en ligne\":consultationRaw.toLowerCase()===\"physique\"?\"physique\":\"inconnue\";setReminderMessage(`Vous avez une consultation ${consultationType} aujourd'hui à ${appointment.time}, l'un de nos meilleurs avocats sera avec vous.`);setHasAppointmentToday(true);// ✅ active les boutons\n}else{setReminderMessage(\"Aucun rendez-vous prévu pour aujourd'hui.\");setHasAppointmentToday(false);// ❌ désactive les boutons\n}}else{setReminderMessage(\"Aucun rendez-vous trouvé.\");}}catch(error){console.error(\"Erreur lors du rappel :\",error);setReminderMessage(\"Erreur lors de la récupération du rappel.\");}};fetchReminder();},[]);return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsx(UserProfileView,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"appcontainer\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Rappel\"}),/*#__PURE__*/_jsxs(\"h4\",{children:[\" \",reminderMessage,\" \"]}),hasAppointmentToday&&/*#__PURE__*/_jsxs(\"div\",{className:\"op\",children:[/*#__PURE__*/_jsx(\"a\",{href:\"https://buy.stripe.com/test_cN2bJIceDgFG2KA000\",children:/*#__PURE__*/_jsx(\"button\",{className:\"Folssa\",children:\"Confirmer\"})}),/*#__PURE__*/_jsx(Link,{to:\"/profile\",children:/*#__PURE__*/_jsx(\"button\",{className:\"Folssa\",children:\"Annuler\"})})]})]})]});};export default ReminderPage;","map":{"version":3,"names":["React","useState","useEffect","axios","Link","UserProfileView","Navbar","jsx","_jsx","jsxs","_jsxs","ReminderPage","hasAppointmentToday","setHasAppointmentToday","reminderMessage","setReminderMessage","fetchReminder","token","localStorage","getItem","usrId","console","error","config","headers","Authorization","response","get","appointment","data","time","date","today","Date","toISOString","split","appointmentDate","_appointment$appointm","consultationRaw","appointmentDetails","consultation","consultationType","toLowerCase","children","className","href","to"],"sources":["C:/Users/RanimSaidi/Desktop/siteavocat-dev-Client/src/components/profil/reminder.js"],"sourcesContent":["// ReminderPage.js\nimport \"./profil.css\";\nimport React, { useState, useEffect } from \"react\";\nimport axios from \"axios\";\nimport { Link } from \"react-router-dom\";\nimport UserProfileView from \"./seeProfil\";\nimport Navbar from \"../navbar/navbar\";\n\n\nconst ReminderPage = () => {\n  const [hasAppointmentToday, setHasAppointmentToday] = useState(false);\n  const [reminderMessage, setReminderMessage] = useState(\"\");\n\nuseEffect(() => {\n  const fetchReminder = async () => {\n    try {\n      const token = localStorage.getItem(\"token\");\n      const usrId = localStorage.getItem(\"uid\");\n\n      if (!token || !usrId) {\n        console.error(\"Token or user ID missing\");\n        return;\n      }\n\n      const config = {\n        headers: {\n          Authorization: `Bearer ${token}`,\n        },\n      };\n\n      const response = await axios.get(\n        `https://avocat-backend.onrender.com/api/appointment/details/${usrId}`,\n        config\n      );\n\n      const appointment = response.data;\n\n      if (appointment && appointment.time && appointment.date) {\n        const today = new Date().toISOString().split(\"T\")[0]; // yyyy-mm-dd\n        const appointmentDate = appointment.date.split(\"T\")[0];\n\n      //Afficher les boutons confirmer et annuler que lorsque user a un RDV\n      if (appointmentDate === today) {\n        const consultationRaw = appointment.appointmentDetails?.consultation || \"\";\n\n        const consultationType =\n          consultationRaw.toLowerCase() === \"phone\"\n            ? \"téléphonique\"\n            : consultationRaw.toLowerCase() === \"online\"\n            ? \"en ligne\"\n            : consultationRaw.toLowerCase() === \"physique\"\n            ? \"physique\"\n            : \"inconnue\";\n\n        setReminderMessage(\n          `Vous avez une consultation ${consultationType} aujourd'hui à ${appointment.time}, l'un de nos meilleurs avocats sera avec vous.`\n        );\n\n        setHasAppointmentToday(true); // ✅ active les boutons\n      } else {\n        setReminderMessage(\"Aucun rendez-vous prévu pour aujourd'hui.\");\n        setHasAppointmentToday(false); // ❌ désactive les boutons\n      }\n      } else {\n        setReminderMessage(\"Aucun rendez-vous trouvé.\");\n      }\n    } catch (error) {\n      console.error(\"Erreur lors du rappel :\", error);\n      setReminderMessage(\"Erreur lors de la récupération du rappel.\");\n    }\n    \n  };\n\n\n\n  fetchReminder();\n}, []);\n\n\n  return (\n    <div>\n      <Navbar />\n      <UserProfileView />\n      <div className=\"appcontainer\">\n        <h1>Rappel</h1>\n        \n        <h4>\n          {\" \"}\n          {reminderMessage}\n          {\" \"}\n        </h4>\n        {hasAppointmentToday && (\n          <div className=\"op\">\n            <a href=\"https://buy.stripe.com/test_cN2bJIceDgFG2KA000\">\n              <button className=\"Folssa\">Confirmer</button>\n            </a>\n\n            <Link to=\"/profile\">\n              <button className=\"Folssa\">Annuler</button>\n            </Link>\n          </div>\n        )}\n\n      </div>\n    </div>\n  );\n};\n\nexport default ReminderPage;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}